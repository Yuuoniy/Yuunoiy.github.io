---
title: CTF | XMAN-硬件安全
date: 2018-08-16 09:04:06
tags:
categories: CTF
---
破解一些终端... 售卖机等
- 右键打发(目标：呼出文件管理)
  - 长按右键 呼出属性 帮助 打印 
  - 长按右键 关于flash 进而呼出文件管理

窗口切换时，快速点点点
窗口焦点变化时，退出全屏，呼出桌面
- 异常信息
- 加载插件
点选文字等进行拖拽，退出全屏
寻找url连接
断电重启打法
- 

android 端：顶栏下拉，输入法中设置

- 呼出软键盘
- osk.exe
- 输入法自带的软键盘
- 去网站下载准备好的木马

软键盘全被删除
- 输入法软键盘
- 记事本粘贴拼凑

- 重启大法也无能为力，启动时隐藏开始菜单，只有快速闪过的命令行
  - 以最快的速度，找到最近浏览

- 不通网
  - 拿下一台这个域的机器
  - 自己连入该网络，共享数据or主动获取数据

- 可造成的危害
...
防范措施
- 禁止断电，重启后几秒内触碰失效
- 针对右键：禁用右键

### 黑科技
#### 无线电安全
随意收发不同频率电磁波
无线电分不同频率，wifi 蓝牙：2.4GHz
软件无线电：可以收发广泛频率的无线电信号的设备 

调谐器-检波器-放大器-扬声器

##### hackrf
入门 1000+
覆盖频段：30MHz-6Ghz
带宽：20Mhz
伪造GPS 信号，接受ADSB,
USRP 接收无线电信号 

- Gunradio 界面-FM发射
  包含 源 处理模块  调幅 调频 输出
- ADSB 信号跟踪飞机 1090MHZ

#### GPS 系统
- 4 颗卫星完成定位
- 
- 
- 根据星历，和目标位置 时间

##### 伪造
- 星历文件
- gps-sdr-sim

##### 危害
- 控制定位
- 污染导航
- 解除一些限制eg:北京飞行器禁飞限制
- 修改机器时间,GPS授时，解除时间限制等
- 网络混乱
- Apollo 自动驾驶依靠GPS&RTK精确定位，是否也受影响?

#### 中间人攻击
##### 手机有什么安全问题
- 2G GSM，
  - 单向鉴权并非双向
  - 伪造基站
- 伪基站
  - 结构
    - 收发板
      - usrP 抄板
    - 功放
    - 双工器
    - 电源
    - 天线
    - 外部笔记本+软件 openbts 2.8 开源基站系统

- 伪基站及产业链
  - 诈骗信息
  - 违法信息
  - 广告推销
  - ssrp 板子 行情不好

- 伪基站原理
  - 基于openbts2.8+usrp1
  - 吸入关键：路径损耗值 C1 小区重选参数C2
    - 手机开机（小区选择）看C1 主要由信号强度决定
    - 小区重选看C2，通过参数CRO,PT等人为影响重选

伪基站做了什么
1. 寻找弱频点 MCC MNC 等参数和周围一样，LAC不一样
2. 手机获知广播信息，C1 C2大，重选小区到伪基站 LAC 变，位置更新请求
3. 鉴权信息 
4. 伪基站看IMSI ，发短信


检测伪基站
- 硬件检测
  - 异常LAC
  - 异常信号强度，C1 C2
  - 对不上的MMC MNC LAC celllD
- 运营商检测
  - 一段时间内
- APP 检测

传统伪基站问题
- 只能在2G环境下，url还需要钓鱼成功
- 伪基站
  - 2 3 4 G都可以。多模手机下，电信也没有问题
  - 对流量完全劫持
  - 短信 数据 童话都可以控制

国内使用500W 600-1000MHZ 定向干扰器  
伪基站 gprs监听  
`bladerf+yatebts`  
- 关键技术点
  - 搭建BTS,主动搜索连入
  - 实际攻击场景，需要被动连入
  - 结合伪基站的思路，修改yatebts源码，增强C2
  - bingo

短信明文
- A5/1 加密被破解
- 国内2G SMS 明文传输

- GSM SMS 监听

#### 共享单车安全
云端-GSM-主控-GPS
OFO：每次通信时会取下次的密码 
分类：
- 自主研发
- 采购 自研平台

#### 儿童手表
#### wifi安全
破解方式
- wep 加密
- pin码加密
- wpa也有办法
- 神器-wifi万能钥匙
跑包

搞到wifi:
- ARP中间人，获取&控制流量
  - 污染DNS
  - 盗取cookie
  - 更改流量数据
- 入侵路由留后门，改dns

企业 ：漫游内网

如何挖web相关漏洞：
src:web 移动
web:
- 子域名爆破 IP 段 端口扫描 mnscan  无状态扫描 80 21 21 23 3300 6379 11211 
小业务 
IP 反查域名
url 路径爆破 爬虫
注入 上传 管理系统 留言板xss cms漏洞 struct2
其他思路：
网盘信息泄露
qq群混入
无线问题
黑产信息
nmap 扫描端口看是什么服务

## 生物识别
常见的生物识别都存在易于获取，反而不安全
- 指纹
- 人脸
- 红魔
- 指静脉
- 声音
- DNA
- 掌纹
密码学中的验证
  - 我是谁 指纹 虹膜 面部
  - 我有什么token 证书 U盾
  - 我知道什么 密码 安全问题 订单 好友

特征识别技术：
  - 唯一性？
  - 无法被看见，甚至表皮下，就无法被偷走?
  - 检测设备只认活的?
  - 单一性?
研究思路
  - 控制传感器看到的内容
#### 指纹识别
光学 电容
识别过程
- 指纹图像获取
  - 光学折射原理
  - 电荷感应 
- 预处理
  计算方向场 图像增强 二值化，细化   特征提取 
- 图像增强
- 特征处理

### 指纹图像获取
### 制作假指纹
  根据成像原理，必须实现凹凸
  光敏刻章，采用光敏成型
  解决导电性问题

### 有趣的问题
左右拇指/食指
活体检测不奏效
解锁设备上本身就有大量指纹
如何通过特征，反推指纹，万能指纹

### 虹膜识别
- 识别过程
  - 红外光照射眼球
    不可见，具有穿透性 
    夜视仪 遥控器 监控。 人体不同组织对红外光吸收不一样
  - 捕捉虹膜图像
  - 利用算法定位
  - 其余和指纹类似

红外相机：CMOS/CCD 本身具备捕获近红外的能力
- 大多被封印
- 需要去除低通滤镜
- 同时加上840nm红外截止镜

识别处理算法
图像获取-定位-眼睑检测-睫毛检测-归一化-虹膜特征码提取
hough 斌换

#### 如何破解
对虹膜识别仪进行拆解分析，hook到获取的图像
激光黑白打印机碳粉对近红外吸收效果好 

红外光透视 湿的更好

#### 指静脉识别
- 对手指照射近红外光
- 对血管中血红蛋白对进红外光吸收，颜色加深
- 对静脉进行采集
- 滤波器对静脉脉络进行处理

识别处理算法
图像增强：高斯滤波 gabor 
静脉分割：


bypass:
。。。
#### 人脸识别
- 依靠摄像头 传统算法 深度学习
- 运用最多活体检测的生物识别
- 人脸范围监测点 

bypass:
- 普通环境
激光打印红外照片 
喷墨打印机
激光打印机 

- 支付环境
  - 静态图像检测
  - 主动检测

FACEID：
  - 采集了人脸的三维信息
  - 采用结构光技术
  - 小型的kinect


  各种生物识别类似
  攻击方法
  用其他设备捕获生物特征-寻找可以让传感器看到类似特征的截止-优化特征，欺骗传感器

推荐博客：
雪碧：https://cn0xroot.com/ 
